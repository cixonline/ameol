<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
   <title>Edit Rule Dialog Box</title>
   <meta name="generator" content="Help & Manual">
   <meta name="keywords" content="Creating Rules,Edit Rule,Marking Messages,Moving messages,Rules">
</head>



<body bgcolor="#FFFFFF">


<table width="100%" border="0" cellspacing="0" cellpadding="2" bgcolor="#FFFF80">
  <tr>
    <td align="left">
      
<span style="font-family:Helvetica,Arial; font-size:12pt; color:#000000"><b><i>Edit Rule Dialog Box
<br>
</i></b></span>
    </td>
    <td align="right">
     <font face="Arial" size="2">
     <a href="91twgs.htm">Previous</a>&nbsp;
     <a href="indgag_cs.htm">Top</a>&nbsp;
     <a href="ind57vsb1.htm">Next</a>
     </font>
    </td>
  </tr>
</table>
<br>


<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">
<br>
(<a href=ind15v3z_.htm>Route</a> :<a href=ef_z24.htm>Settings Menu</a>, <a href=rules_menu_command.htm>Rules Command</a>, <a href=new__rule__button.htm>New</a> or <a href=edit__rule__button.htm>Edit</a> Buttons)
<br>

<br>
The Edit Rule dialog box allows you to test incoming messages to a specified folder to see if they meet certain criteria.
<br>

<br>
<map name="_BM36"><area shape="rect" coords="23,257,373,371" href="mark_message_options.htm"><area shape="rect" coords="24,403,356,425" href="mail_form_option.htm"><area shape="rect" coords="323,375,380,399" href="new_rule_folder_button.htm"><area shape="rect" coords="26,377,317,398" href="move_to_option.htm"><area shape="rect" coords="18,170,282,231" href="succeed_when_option.htm"><area shape="rect" coords="26,143,295,165" href="message_body__rules__text_box.htm"><area shape="rect" coords="60,118,295,141" href="subject_rule_text_box.htm"><area shape="rect" coords="106,99,205,117" href="inspect_cc_field_check_box.htm"><area shape="rect" coords="68,76,297,95" href="to__rule__text_box.htm"><area shape="rect" coords="66,51,296,73" href="from__rule__text_box.htm"></map><img src="_bm36.jpg" width="401" height="449" border="0" alt="_bm36" ismap usemap="#_BM36">
<br>

<br>
This is a Hot Spot image. Move your mouse pointer over the image
<br>
and when the mouse pointer changes to the shape of a hand click
<br>
the left mouse button once for extra help.
<br>

<br>

<br>
If the messages do meet the criteria you have the option to perform a number of functions on the message.
<br>

<br>
In the <b>From</b> and <b>To</b> text boxes, enter the name of an author that you would like to search incoming messages for. If you check <b>Inspect CC field</b>, the CC field of the incoming message will also be tested for the specified author's name.
<br>

<br>
In the <b>Subject</b> and <b>Message Body</b> text boxes enter a word or string of characters that you would like search for in the subject and body of a message.
<br>

<br>
If an incoming message meets all of the criteria that you have specified in the text boxes you can choose to apply any of the options in the lower part of the dialog.
<br>

<br>
<b>Delete the message</b> will delete the message before it enters your message database.
<br>

<br>
<b>Mark message priority </b>will treat the message as normal but will mark it as high priority. You can quickly go to any priority messages by pressing F5 (see other <a href=key6ooe_f.htm>Keyboard Shortcuts</a>).
<br>

<br>
<b>Mark message ignored</b> will grey out the message in the message window and mark the message and comments to it as having been read.
<br>

<br>
<b>Mark message read</b> will mark the message as having been read.
<br>

<br>
<b>Mark message tagged</b> will tag the article so that the message body will be retrieved the next time Ameol connects to your Usenet service.
<br>

<br>
<b>Mark message bookmarked</b> will place a bookmark at that message. You can find the next and previous bookmarks using the <b>Next</b> and <b>Previous Bookmark</b> commands from the <b>View</b> menu.
<br>

<br>
<b>Mark message kept</b> will mark the message to be kept. Kept messages are never purged.
<br>

<br>
<b>Mark message read-locked</b> will mark the message as always unread.
<br>

<br>
<b>Mark message watched</b> will tag the message and any comments to it.
<br>

<br>
<b>Move to</b> will move the message to the folder chosen from the list, or to a folder created by using the <b>New</b> button.
<br>

<br>
When you have finished setting up the rule, click the <b>OK</b> button. The rule will then be applied to all incoming messages to the specified folder.
<br>

<br>
Some more information on rules:
<br>

<br>
</span><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="0"></td><td width="25"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Symbol; font-size:10pt; color:#000000"><font face="Symbol">&#183;</font></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"></span></span></td><td><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">&nbsp;&nbsp;&nbsp;The logic employed is AND. That is, if you specify a From, To and Subject field, then only if a message matches all three criteria is the rule deemed to be successful.
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="0"></td><td width="25"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"></span></td><td></td></tr></table><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">
<br>
</span><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="0"></td><td width="25"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Symbol; font-size:10pt; color:#000000"><font face="Symbol">&#183;</font></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"></span></span></td><td><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">&nbsp;&nbsp;&nbsp;For the From and To field, you can specify either a username or a fully-qualified e-mail address. For example:
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="0"></td><td width="25"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"></span></td><td></td></tr></table><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">   
<br>
      Username:   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; simon
<br>
      Qualified Address:   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; simon@cix.compulink.co.uk
<br>

<br>
If you specify a username only, then mail to that username from any domain will match. Given the above example, mail from or to any of the following will match a username of simon:
<br>
               simon@cix.compulink.co.uk
<br>
               simon@compulink.co.uk
<br>
               simon@another.domain.co.uk
<br>
               simon@msn.com
<br>

<br>
   The following will NOT match:
<br>
               simon_cleland@cix.compulink.co.uk
<br>
               dr_simon@msn.com
<br>

<br>
If you specify a fully qualified address, then only mail from or to that address will match. In the examples given above, only mail from or to simon@cix.compulink.co.uk will match.
<br>

<br>
To match ANY user within a particular domain, specify the domain:
<br>

<br>
               @compulink.co.uk
<br>

<br>
If you specify this in the From or To field, then e-mail to or from any of the following will match the rule:
<br>

<br>
               simon@compulink.co.uk
<br>
               horus@compulink.co.uk
<br>
               i_am_a_duck@compulink.co.uk
<br>
<span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">
<br>
</span><span style="font-family:Symbol; font-size:10pt; color:#000000"><font face="Symbol">&#183;</font></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All text in the fields is not case sensitive. So simon, Simon and SIMON will all match a rule.
<br>

<br>
</span></span><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="0"></td><td width="25"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><span style="font-family:Symbol; font-size:10pt; color:#000000"><font face="Symbol">&#183;</font></span><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"></span></span></td><td><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">&nbsp;&nbsp;&nbsp;When moving a message to another topic, any rules in the destination topic are applied to the message. This may result in the message being moved further. Ameol will handle circular instances and will not move a message back to the original topic.
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="0"></td><td width="25"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000">
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="0"></td><td width="25"><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"></span></td><td></td></tr></table><span style="font-family:Helvetica,Arial; font-size:10pt; color:#000000"><b>Mail Form</b> will cause a mail form to be used.
<br>

<br>
<b>What are forms?</b>
<br>

<br>
First of all:
<br>

<br>
<b>Forms are rather complex and we recommend that only advanced Ameol users try them.
<br>
</b>
<br>
Forms are an extension to the rules in Ameol. Using a form is an extra action that can be triggered by a rule. Any  message which matches the rule can instruct Ameol to e-mail a predefined mail message back to the sender of that message. Forms are not completely integrated into Ameol and support for them is done on a "best-effort" basis. This means the ultimate resolution to a problem may be "stop using forms." The use of forms is only supported in v2.12.1885 and above.
<br>

<br>
Mail forms are text files that are stored in the FORMS subdirectory in the Ameol base directory and must have the extension .afm. If any forms are found when Ameol is started up an extra entry, "Mail Form" will appear on the Edit Rule dialog (Settings|Rules|New). If no FORMS directory is found when Ameol is started, or it does not contain any .afm files, mail forms are disabled and the extra option does not appear on the Rules dialog.
<br>

<br>
Ameol reads the forms directly once only, when it starts up. If you add extra forms while Ameol is running you have to exit and restart Ameol before the new forms can be seen.
<br>

<br>

<br>
<b>Examples
<br>
</b>
<br>
I can get e-mail to enquiries@mycompany.co.uk with a Subject line of 'Prices'. I set up a rule to match 'Prices' in the Subject field and to e-mail the sender the current price list in response. (N.B., This is an example and is not in real use.)
<br>

<br>
A sample mail form that would fulfill this function is:
<br>

<br>
    To: $FROM$
<br>
    Subject: Our price list
<br>
    
<br>
    Thanks for your enquiry about our pricing. A price list is
<br>
    enclosed below.
<br>
    ...
<br>

<br>
A mail form is divided into two parts. The header part contains instructions to fill the To:, CC:, Subject, and Reply To: fields of the outgoing mail message. Then a blank line separates the header from the text body part.
<br>

<br>
In the above example, the name of the recipient is picked up from the $FROM$ macro which is filled in with the sender of the message which matched the rule. In the example, if I e-mailed enquiries@mycompany.co.uk from an account called test@cix.co.uk, the $FROM$ macro will expand to 'test@cix.co.uk'. $FROM$ does not use the Reply-To address of an incoming mail message.
<br>

<br>
The text body part also permits a macro called $INCLUDE$ which will pull in the contents of another file. Thus:
<br>

<br>
    Thanks for your enquiry about our pricing. A price list is
<br>
    enclosed below.
<br>
    
<br>
    $INCLUDE$  C:\Ameol\Pricing\Pricing.txt
<br>

<br>
would retrieve the current price list from that location.
<br>

<br>
Even better, the pathname in the $INCLUDE$ macro can contain a macro. You can use this facility to set up an automatic help system. In this example, I can e-mail help@mycompany.co.uk and specify a help topic in the subject field. The mail form created for the help folder in Ameol is as follows:
<br>

<br>
    To: $FROM$
<br>
    Subject: Help on $SUBJECT$
<br>
    
<br>
    $INCLUDE$ C:\Ameol\Helpfiles\$SUBJECT$.TXT
<br>

<br>
Thus if I mail help@mycompany.co.uk a message with a Subject of 'Features', the mail form will expand to:  
<br>

<br>
    To: author
<br>
    Subject: Help on Rules
<br>
    
<br>
    $INCLUDE$ C:\Ameol\Helpfiles\Features.txt
<br>

<br>
and will pull in the contents of Features.txt at this point in the message.
<br>

<br>
What happens if the user specifies a subject that doesn't match? If the $INCLUDE$ fails then Ameol will look for a file called !ERROR!.TXT in the given directory. This file can be set up to contain the following:
<br>

<br>
     Sorry, there is no help on this subject. A full list of valid
<br>
     subjects appear below:
<br>
     ...
<br>

<br>
If !ERROR!.TXT is not found, then an error is embedded in the outgoing form.
<br>

<br>
You can also return files via mail forms. The extra header field, Attachment, will attach a file in the mail message. If the recipient address is on CIX, the file is sent as binmail otherwise it is sent uuencoded/base64 depending on the option selected. 
<br>

<br>
Here are two more examples. If you want to reject all e-mail from a particular person, create a rule to redirect all e-mail from that person to another folder and create the following mail form on that folder:
<br>

<br>
   To: $FROM$
<br>
   Subject: Re: $SUBJECT$
<br>
   
<br>
   I'm bored with listening to you. Please go away!
<br>

<br>
Or how about forwarding incoming e-mail to another address when you're on holiday?
<br>

<br>
   To: ms_secretary@joe_bloggs.co.uk
<br>
   Subject: Fw: $SUBJECT$
<br>
   
<br>
   ---- Forwarded Message ----
<br>
   $TEXT$
<br>

<br>
The $TEXT$ macro pulls in the contents of the message that matches. You also have $BODY$ that only pulls in the body and not the header.
<br>

<br>

<br>
<b>WARNING</b>
<br>

<br>
Forms are a very powerful feature, but there are some problems of which you should be aware. 
<br>

<br>
1. Say you set up a rule and form similar to the "reject all email" example above. Now imagine that the person you are ignoring email from has set up a similar rule and form. The other person sends you a message, which triggers your rule, sending a form email message out. This then triggers their rule, sending you an email message, which triggers your rule. The result is a mail loop, the two systems spend all their time sending each other mail. If you do not detect and fix this problem rapidly you can expect your ISP to cut off your incoming email until you do fix it.
<br>

<br>
2. Be very careful setting up rules and forms which match the subject field only. Say you set up a rule and form to match the subject line, where if the subject contains "prices" your price list is sent. If your form uses "Re: $SUBJECT$" then the CC of the outgoing mail message with your price list in it will also match the rule, so you will end up sending yourself mail for ever - another mail loop.
<br>

<br>
3. You should not create forms using versions of AmEdit earlier than v1.04. If you are not able to use 1.04 or later you should use an alternate editor.
<br>

<br>

<br>
<b>Summary
<br>
</b>
<br>
1. Forms must have the file extension .afm and must be saved in a Forms sub-directory off your main Ameol directory.
<br>

<br>
2. The Forms folder is only read once per session, when Ameol is started up. If you add a Forms directory or some new forms to the Forms directory while Ameol is running you will need to quit and restart Ameol before the changes will be apparent.
<br>

<br>
3. Valid lines in the header part of the form are:
<br>

<br>
   To:
<br>
   CC:
<br>
   Reply-To:
<br>
   Subject:
<br>
   Attachment:
<br>

<br>
4. The header and body sections of a mail form are separated by one or more blank lines.
<br>

<br>
5. Valid macros in forms are:
<br>

<br>
   $FROM$    - expands to the full email address of the person who sent the mail. This is taken from the Reply-To: field if it exists, otherwise from the From: field.
<br>

<br>
   $SUBJECT$ - expands to the subject of the incoming mail message
<br>

<br>
   $TEXT$    - expands to the full text of the incoming message, including the header
<br>

<br>
   $BODY$    - expands to the full text of the incoming message, excluding the header
<br>

<br>
   $INCLUDE$ - used with a path and filename, includes that file in the outgoing message
<br>

<br>
<span style="font-family:Times New Roman; font-size:11pt; color:#000000">
<br>
<a name="ind57vsb1"></a>
<br>
</span></span>

</body>
</html>
